(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{293:function(e,t,a){e.exports=a.p+"static/media/login_3.c155b94e.jpg"},294:function(e,t,a){e.exports=a.p+"static/media/Logo.b29324c4.svg"},302:function(e,t,a){e.exports=a(585)},315:function(e,t,a){},367:function(e,t,a){},368:function(e,t,a){},370:function(e,t,a){},519:function(e,t,a){},525:function(e,t,a){},536:function(e,t,a){},575:function(e,t,a){},576:function(e,t,a){},577:function(e,t,a){},580:function(e,t,a){},581:function(e,t,a){},582:function(e,t,a){},584:function(e,t,a){},585:function(e,t,a){"use strict";a.r(t);a(303);var n=a(295),r=a(15),l=a(16),o=a(19),c=a(17),i=a(18),s=a(0),u=a.n(s),d=a(11),m=a.n(d),p=a(35),f=a(95),h=(a(48),a(25)),y=a(29),g=(a(173),a(119)),E=(a(86),a(7)),v=(a(137),a(43)),b=(a(51),a(20)),C=(a(315),[{key:"/docm",title:"\u9879\u76ee\u5408\u540c",role:["normal"]},{key:"/user",title:"\u8d26\u53f7\u7ba1\u7406",role:["admin"]},{key:"/operlog",title:"\u65e5\u5fd7\u5ba1\u8ba1",role:["admin"]},{key:"/account",title:"\u6211\u7684\u8d26\u53f7",role:["normal","admin"]}]),k=h.a.Header,O=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).fetchDefaultSelectedKey=function(e){var t=a.props.location.pathname,n=e.map(function(e){return e.key}),r=n.filter(function(e){return t.indexOf(e)>=0});return r.length<1?[n[0]]:r},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=u.a.createElement(v.b,null,u.a.createElement(v.b.Item,null,u.a.createElement(b.a,{onClick:function(){e.props.history.push("/main/account/mod-pwd")}},"\u4fee\u6539\u5bc6\u7801")),u.a.createElement(v.b.Item,null,u.a.createElement(b.a,{onClick:function(){sessionStorage.removeItem("userId"),setTimeout(function(){e.props.history.push("/login")},300)}},"\u9000\u51fa")));return u.a.createElement(ma.Consumer,null,function(a){var n=C.filter(function(e){return"admin"===a.username?e.role.filter(function(e){return"admin"===e}).length>0:e.role.filter(function(e){return"normal"===e}).length>0}),r=e.fetchDefaultSelectedKey(n);return u.a.createElement("div",null,u.a.createElement(k,{className:"header"},u.a.createElement(v.b,{className:"navbar",theme:"dark",mode:"horizontal",selectedKeys:r,style:{lineHeight:"50px"},onSelect:function(t){var a=e.props,n=a.history,r=a.match;n.push(r.path+t.key)}},n.map(function(e){return u.a.createElement(v.b.Item,{className:"navbar-item",key:e.key},e.title)})),u.a.createElement(v.b,{className:"userbar",theme:"dark",mode:"horizontal",style:{lineHeight:"50px"},selectable:!1},u.a.createElement(v.b.Item,{key:"user"},u.a.createElement(g.a,{overlay:t,placement:"bottomRight"},u.a.createElement("span",null,u.a.createElement(E.a,{style:{fontSize:"18px",color:"#fff"},type:"user"}),u.a.createElement("span",{style:{fontSize:"18px",color:"#fff",margin:"0 8px 0 0"}},a.username),u.a.createElement(E.a,{style:{color:"#fff"},type:"caret-down"})))))))})}}]),t}(s.Component),w=Object(f.g)(O),x=(a(367),a(368),a(129),a(37)),j=(a(370),a(34)),S=a.n(j),D=a(46),I=(a(83),a(30)),T=(a(226),a(166)),N=(a(56),a(9)),A=(a(69),a(24)),F=(a(77),a(33)),L=a(280),z=a.n(L),P=a(59),M="http://aby.docm.com:8090",B=z.a.create({baseURL:M,withCredentials:!1,timeout:6e4});B.interceptors.request.use(function(e){var t=sessionStorage.getItem("xAuthToken");return t&&(e.headers["x-auth-token"]=t),e},function(e){console.error("\u8bf7\u6c42\u5f02\u5e38")}),B.interceptors.response.use(function(e){var t=e.headers["x-auth-token"];return t&&sessionStorage.setItem("xAuthToken",t),e},function(e){401===e.response.status&&(sessionStorage.removeItem("userId"),A.a.error("\u767b\u5f55\u8d85\u65f6\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55",3),setTimeout(function(){Object(P.b)().push("/login")},500)),403===e.response.status&&A.a.error("\u60a8\u6ca1\u6709\u8bbf\u95ee\u6743\u9650",3)});var Y=B,R=a(104),K=a.n(R),H=h.a.Content,_=F.a.Option,q=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).form=void 0,a.handleCancel=function(e){e.preventDefault(),a.props.history.push("".concat(Le,"/list"))},a.handleSubmit=function(e){e.preventDefault(),a.form&&a.form.props.form.validateFields(function(e,t){if(!e){var n=Object(y.a)({},t,{password:K()(t.password?t.password:"1234"),dept:{id:t.dept}});Y.put("/user",n).then(function(e){"00000000"===e.data.status?a.props.history.push("".concat(Le,"/list")):A.a.error(e.data.message)}).catch(function(e){A.a.error(e.response.data.message)})}})},a.handlePermOnChange=function(e){a.form&&a.form.props.form.setFieldsValue({permissions:e.map(function(e){return{id:e}})}),a.setState({permissions:e})},a.handleDeptOnChange=function(e){a.form&&a.form.props.form.setFieldsValue({dept:e})},a.state={treeData:[],permissions:[],deptData:[]},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;Y.get("/perm/all").then(function(t){var a=t.data.data.map(function(e,t){return{key:t,title:e.group,value:void 0,children:e.permissions.map(function(e){return{key:e.id,title:e.name,value:e.id}})}});e.setState({treeData:a})}).catch(function(e){}),Y.post("/dept/list-all").then(function(t){e.setState({deptData:t.data.data})}).catch(function(e){})}},{key:"render",value:function(){var e=this,t=this.state,a=t.treeData,n=t.permissions,r=t.deptData;return u.a.createElement(H,null,u.a.createElement("div",{style:{margin:"4px 4px 10px",display:"flex",alignItems:"center"}},u.a.createElement("div",{style:{order:2,flexGrow:1,padding:"0 8px 0 0"}},u.a.createElement("span",{style:{float:"right"}},u.a.createElement(b.a,{block:!0,type:"default",onClick:this.handleCancel},"\u8fd4\u56de")))),u.a.createElement("div",{style:{margin:"8px"}},u.a.createElement(G,{wrappedComponentRef:function(t){e.form=t}}),u.a.createElement(N.a,U,u.a.createElement(N.a.Item,{key:"dept",label:"\u6240\u5c5e\u79d1\u5ba4"},u.a.createElement(F.a,{style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9",showSearch:!0,allowClear:!0,optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0},onChange:this.handleDeptOnChange},r.map(function(e){return u.a.createElement(_,{key:e.id,value:e.id},e.name)}))),u.a.createElement(N.a.Item,{key:"permissions",label:"\u8d26\u53f7\u6388\u6743"},u.a.createElement(T.a,{style:{width:"100%"},searchPlaceholder:"\u8bf7\u9009\u62e9",multiple:!0,showSearch:!1,treeData:a,value:n,treeCheckable:!0,onChange:this.handlePermOnChange})),u.a.createElement(N.a.Item,W,u.a.createElement(b.a,{block:!0,type:"primary",onClick:this.handleSubmit},"\u63d0\u4ea4")))))}}]),t}(u.a.Component),V=Object(f.g)(q),U={labelCol:{xs:{span:20},sm:{span:4}},wrapperCol:{xs:{span:20},sm:{span:16}}},W={wrapperCol:{xs:{span:2,offset:0},sm:{span:2,offset:4}}},$=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return u.a.createElement(N.a,U,e("id")(u.a.createElement(I.a,{hidden:!0})),u.a.createElement(N.a.Item,{key:"username",label:"\u7528\u6237\u540d"},e("username",{rules:[{required:!0,type:"string",pattern:/^[a-zA-Z][a-zA-Z0-9_]{2,11}$/,message:"\u7528\u6237\u540d\u4e3a3~12\u4f4d\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf,\u7b2c\u4e00\u4f4d\u5fc5\u987b\u4e3a\u5b57\u6bcd"},{message:"\u7528\u6237\u540d\u5df2\u5b58\u5728",validator:function(){var e=Object(D.a)(S.a.mark(function e(t,a,n,r,l){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.get("/user/check-unique-username?username=".concat(a)).then(function(e){if("00000000"===e.data.status){var t=!0===e.data.data||void 0;n(t)}else A.a.error(e.data.message),n()}).catch(function(e){A.a.error("\u670d\u52a1\u5668\u5f02\u5e38"),n()});case 2:case"end":return e.stop()}},e)}));return function(t,a,n,r,l){return e.apply(this,arguments)}}()}],validateTrigger:"onBlur"})(u.a.createElement(I.a,null))),u.a.createElement(N.a.Item,{key:"password",label:"\u5bc6\u7801"},e("password",{rules:[{required:!1,message:"\u5bc6\u7801\u4e3a4~16\u4f4d\u4efb\u610f\u5b57\u7b26",pattern:/^.{4,16}$/}],validateTrigger:"onBlur"})(u.a.createElement(I.a,{type:"password",placeholder:"\u9ed8\u8ba4\u5bc6\u7801\u4e3a1234"}))),u.a.createElement(N.a.Item,{key:"phone",label:"\u624b\u673a"},e("phone",{rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7",max:11}],validateTrigger:"onBlur"})(u.a.createElement(I.a,null))),u.a.createElement(N.a.Item,{key:"email",label:"\u90ae\u7bb1"},e("email",{rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u7bb1",type:"email"}],validateTrigger:"onBlur"})(u.a.createElement(I.a,null))),e("dept"),e("permissions"))}}]),t}(u.a.Component),G=N.a.create({name:"normal_login"})($),Z=h.a.Content,J=F.a.Option,X=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).form=void 0,a.handleCancel=function(e){e.preventDefault(),a.props.history.push("".concat(Le,"/list"))},a.handleSubmit=function(e){e.preventDefault(),a.form&&a.form.props.form.validateFields(function(e,t){if(!e){var n=Object(y.a)({},t,{dept:{id:t.dept}});Y.post("/user",n).then(function(e){"00000000"===e.data.status?a.props.history.push("".concat(Le,"/list")):A.a.error(e.data.message)}).catch(function(e){A.a.error(e.response.data.message)})}})},a.handlePermOnChange=function(e){a.form&&a.form.props.form.setFieldsValue({permissions:e.map(function(e){return{id:e}})}),a.setState({permissions:e})},a.handleDeptOnChange=function(e){a.form&&a.form.props.form.setFieldsValue({dept:e}),a.setState({dept:e})},a.state={id:a.props.match.params.id,loading:!0,treeData:[],permissions:[],deptData:[],dept:""},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.state.id;this.setState({loading:!0},function(){Y.get("/user?id=".concat(t)).then(function(t){var a=t.data.data,n=a.dept?a.dept.id:void 0;e.form&&e.form.props.form.setFieldsValue(Object(y.a)({},a,{dept:n}));var r=a.permissions.map(function(e){return e.id});e.setState({loading:!1,permissions:r,dept:n})}).catch(function(t){e.setState({loading:!1})}),Y.get("/perm/all").then(function(t){var a=t.data.data.map(function(e,t){return{key:t,title:e.group,value:void 0,children:e.permissions.map(function(e){return{key:e.id,title:e.name,value:e.id}})}});e.setState({treeData:a})}).catch(function(e){}),Y.post("/dept/list-all").then(function(t){e.setState({deptData:t.data.data})}).catch(function(e){})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.loading,n=t.treeData,r=t.permissions,l=t.deptData,o=t.dept;return u.a.createElement(Z,null,u.a.createElement("div",{style:{margin:"4px 4px 10px",display:"flex",alignItems:"center"}},u.a.createElement("div",{style:{order:2,flexGrow:1,padding:"0 8px 0 0"}},u.a.createElement("span",{style:{float:"right"}},u.a.createElement(b.a,{block:!0,type:"default",onClick:this.handleCancel},"\u8fd4\u56de")))),u.a.createElement("div",{style:{margin:"8px"}},u.a.createElement(ne,{wrappedComponentRef:function(t){e.form=t}}),u.a.createElement(N.a,ee,u.a.createElement(N.a.Item,{key:"dept",label:"\u6240\u5c5e\u79d1\u5ba4"},u.a.createElement(F.a,{style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9",value:o,showSearch:!0,allowClear:!0,optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0},onChange:this.handleDeptOnChange},l.map(function(e){return u.a.createElement(J,{key:e.id,value:e.id},e.name)}))),u.a.createElement(N.a.Item,{key:"permissions",label:"\u8d26\u53f7\u6388\u6743"},u.a.createElement(T.a,{style:{width:"100%"},searchPlaceholder:"\u8bf7\u9009\u62e9",multiple:!0,treeData:n,value:r,treeCheckable:!0,onChange:this.handlePermOnChange})),u.a.createElement(N.a.Item,te,u.a.createElement(b.a,{block:!0,type:"primary",loading:a,onClick:this.handleSubmit},"\u4fdd\u5b58")))))}}]),t}(u.a.Component),Q=Object(f.g)(X),ee={labelCol:{xs:{span:20},sm:{span:4}},wrapperCol:{xs:{span:20},sm:{span:16}}},te={wrapperCol:{xs:{span:2,offset:0},sm:{span:2,offset:4}}},ae=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form,t=e.getFieldDecorator,a=e.getFieldValue;return u.a.createElement(N.a,ee,t("id")(u.a.createElement(I.a,{hidden:!0})),u.a.createElement(N.a.Item,{key:"username",label:"\u7528\u6237\u540d"},t("username",{rules:[{required:!0,type:"string",pattern:/^[a-zA-Z][a-zA-Z0-9_]{2,11}$/,message:"\u7528\u6237\u540d\u4e3a3~12\u4f4d\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf,\u7b2c\u4e00\u4f4d\u5fc5\u987b\u4e3a\u5b57\u6bcd"},{message:"\u7528\u6237\u540d\u5df2\u5b58\u5728",validator:function(){var e=Object(D.a)(S.a.mark(function e(t,n,r,l,o){var c;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=a("id"),e.next=3,Y.get("/user/check-unique-username?username=".concat(n,"&id=").concat(c)).then(function(e){if("00000000"===e.data.status){var t=!0===e.data.data||void 0;r(t)}else A.a.error(e.data.message),r()}).catch(function(e){A.a.error("\u670d\u52a1\u5668\u5f02\u5e38"),r()});case 3:case"end":return e.stop()}},e)}));return function(t,a,n,r,l){return e.apply(this,arguments)}}()}],validateTrigger:"onBlur"})(u.a.createElement(I.a,null))),u.a.createElement(N.a.Item,{key:"phone",label:"\u624b\u673a"},t("phone",{rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7",max:11}],validateTrigger:"onBlur"})(u.a.createElement(I.a,null))),u.a.createElement(N.a.Item,{key:"email",label:"\u90ae\u7bb1"},t("email",{rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u7bb1",type:"email"}],validateTrigger:"onBlur"})(u.a.createElement(I.a,null))),t("dept"),t("permissions"))}}]),t}(u.a.Component),ne=N.a.create({name:"normal_login"})(ae),re=(a(99),a(58)),le=(a(133),a(78)),oe=(a(109),a(54)),ce=(a(132),a(66)),ie=(a(257),a(122)),se=a(21),ue=a.n(se);function de(e){return e.replace(/([A-Z])/g,"_$1").toLowerCase()}var me=h.a.Content,pe=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).form=void 0,a.handleListChange=function(){var e=a.props.httpPath;a.setState({loading:!0},function(){var t=a.state,n=t.pageSize,r=t.current,l=t.param,o=Object(y.a)({pageSize:n,current:r},l);Y.post("".concat(e,"/list"),o).then(function(e){a.setState({loading:!1,data:e.data.data})}).catch(function(e){a.setState({loading:!1})})})},a.handleSelectChange=function(e){a.state.param.conditions.keywords=e,a.setState({current:1}),a.handleListChange()},a.handleDeleteOper=function(){var e=Object(D.a)(S.a.mark(function e(t){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a.props.httpPath,ce.a.confirm({title:"\u786e\u5b9a\u5220\u9664?",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){var e="";t.forEach(function(t){return e=e.concat("ids=".concat(t,"&"))}),Y.delete("".concat(n,"?").concat(e.substring(0,e.length-1))).then(function(e){"00000000"===e.data.status?(A.a.success("\u5220\u9664\u6210\u529f"),a.handleListChange()):A.a.error(e.data.message)})}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleOk=function(e){e.preventDefault();var t=a.props.httpPath,n=a.state.modalFlag;a.form&&a.form.props.form.validateFields(function(e,r){if(!e){var l=1===n?Y.put:2===n?Y.post:void 0;l&&l("".concat(t),r).then(function(e){"00000000"===e.data.status?(A.a.success("\u64cd\u4f5c\u6210\u529f"),a.handleListChange()):A.a.error(e.data.message)}).catch(function(e){A.a.error(e.response.data.msg)}),a.setState({modalFlag:0})}})},a.handleCancel=function(e){a.setState({modalFlag:0,modalData:void 0})},a.state={loading:!0,selectedRowKeys:[],data:{total:void 0,content:[]},pageSize:10,current:1,param:{conditions:{},sorters:{}},modalFlag:0,modalData:void 0},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.handleListChange()}},{key:"renderSearchBar",value:function(){var e=this.props.modelName;return u.a.createElement(F.a,{mode:"tags",placeholder:"\u8bf7\u8f93\u5165".concat(e),style:{width:"280px"},tokenSeparators:[" "],showArrow:!0,suffixIcon:u.a.createElement(E.a,{style:{fontSize:"16px"},type:"search"}),onChange:this.handleSelectChange,notFoundContent:null})}},{key:"renderButtonBar",value:function(){var e=this,t=this.state.selectedRowKeys;return u.a.createElement("div",null,u.a.createElement(b.a,{className:"ele-operation",type:"primary",onClick:function(t){t.preventDefault(),e.setState({modalFlag:1})}},"\u65b0\u5efa"),u.a.createElement(b.a,{type:"ghost",disabled:t.length<1,onClick:function(){e.handleDeleteOper(t)}},"\u6279\u91cf\u5220\u9664"))}},{key:"buildColumns",value:function(){var e=this;return[{title:"\u5e8f\u53f7",key:"index",render:function(e,t,a){return a+1},onHeaderCell:function(e){return{style:{textAlign:"center",width:"5%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u540d\u79f0",key:"name",dataIndex:"name",onHeaderCell:function(e){return{style:{textAlign:"center"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u521b\u5efa\u65f6\u95f4",key:"createTime",dataIndex:"createTime",render:function(e,t,a){return ue()(t.createTime).format("YYYY-MM-DD HH:mm:ss")},sorter:function(e,t){return e.id-t.id},onHeaderCell:function(e){return{style:{textAlign:"center",width:"15%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u64cd\u4f5c",key:"operation",render:function(t,a,n){return u.a.createElement("div",null,u.a.createElement(b.a,{type:"link",onClick:function(t){t.preventDefault(),e.setState({modalFlag:2,modalData:a})}},"\u7f16\u8f91"),u.a.createElement(b.a,{type:"link",onClick:function(t){t.preventDefault(),e.handleDeleteOper([a.id])}},"\u5220\u9664"))},onHeaderCell:function(e){return{style:{textAlign:"center",width:"16%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}}]}},{key:"renderTable",value:function(){var e=this,t=this.state,a=t.loading,n=t.selectedRowKeys,r=t.data,l=t.pageSize,o=t.current,c=r.total,i=r.content;return a||r.content.length>0?u.a.createElement(le.a,{rowKey:function(e){return e.id},rowSelection:{columnWidth:"30px",selectedRowKeys:n,onChange:function(t){e.setState({selectedRowKeys:t})}},columns:this.buildColumns(),dataSource:i,loading:a,pagination:{total:c,current:o,pageSize:l,pageSizeOptions:["10","20","50"],showSizeChanger:!0,showTotal:function(e){return"\u5171 ".concat(e," \u6761")}},onChange:function(t,a,n,r){var l=e.state.param,o=t.current,c=t.pageSize,i=n.field,s=n.order;l.sorters={},i&&s&&(l.sorters[de(i)]=function(e){return"descend"===e?"desc":"asc"}(s)),e.setState({current:o,pageSize:c}),e.handleListChange()}}):u.a.createElement(re.a,{description:"\u6682\u65e0\u5185\u5bb9"})}},{key:"renderAddModal",value:function(){var e=this,t=this.state,a=t.modalFlag,n=t.modalData,r="".concat(1===a?"\u65b0\u5efa":2===a?"\u7f16\u8f91":void 0,"\u79d1\u5ba4");return u.a.createElement(ce.a,{title:r,visible:a>0,okText:"\u63d0\u4ea4",cancelText:"\u53d6\u6d88",onOk:this.handleOk,onCancel:this.handleCancel},u.a.createElement(ge,{wrappedComponentRef:function(t){e.form=t,e.form&&(2===a&&n?e.form.props.form.setFieldsValue(Object(y.a)({},n)):1===a&&e.form.props.form.resetFields(["id","name"]))}}))}},{key:"render",value:function(){return u.a.createElement(me,null,u.a.createElement("div",{className:"list-page"},u.a.createElement("div",{className:"list-page-content"},u.a.createElement("div",{className:"list-page-content-toolbar"},u.a.createElement("div",{className:"list-page-content-toolbar-search"},this.renderSearchBar()),u.a.createElement("div",{className:"list-page-content-toolbar-button"},this.renderButtonBar())),u.a.createElement("div",{className:"list-page-content-table"},this.renderTable()))),u.a.createElement("div",null,this.renderAddModal()))}}]),t}(u.a.Component);var fe=Object(f.g)(pe),he={labelCol:{xs:{span:20},sm:{span:4}},wrapperCol:{xs:{span:20},sm:{span:16}}},ye=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return u.a.createElement(N.a,he,e("id")(u.a.createElement(I.a,{hidden:!0})),u.a.createElement(N.a.Item,{key:"name",label:"\u540d\u79f0"},e("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u540d\u79f0"}]})(u.a.createElement(I.a,null))))}}]),t}(u.a.Component),ge=N.a.create({name:"normal_login"})(ye),Ee=(a(519),h.a.Content),ve=F.a.Option,be=ie.a.TabPane,Ce=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).handleListChange=function(){a.setState({loading:!0},function(){var e=a.state,t=e.pageSize,n=e.current,r=e.param,l=Object(y.a)({pageSize:t,current:n},r);Y.post("/user/list",l).then(function(e){a.setState({loading:!1,data:e.data.data})}).catch(function(e){a.setState({loading:!1})})})},a.loadDeptData=function(){a.setState({loading:!0},function(){Y.post("/dept/list-all").then(function(e){a.setState({loading:!1,deptData:e.data.data})}).catch(function(e){a.setState({loading:!1})})})},a.handleSelectChangeForKeyword=function(e){a.state.param.conditions.keywords=e,a.setState({current:1}),a.handleListChange()},a.handleSelectChangeForDept=function(e){a.state.param.conditions.dept={id:e},a.setState({current:1}),a.handleListChange()},a.handleDeleteOper=function(){var e=Object(D.a)(S.a.mark(function e(t){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:ce.a.confirm({title:"\u786e\u5b9a\u5220\u9664?",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){var e="";t.forEach(function(t){return e=e.concat("ids=".concat(t,"&"))}),Y.delete("/user?".concat(e.substring(0,e.length-1))).then(function(e){"00000000"===e.data.status?(A.a.success("\u5220\u9664\u6210\u529f"),a.handleListChange()):A.a.error(e.data.message)})}});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.state={loading:!0,deptData:[],selectedRowKeys:[],data:{total:void 0,content:[]},pageSize:10,current:1,param:{conditions:{},sorters:{}}},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.loadDeptData(),this.handleListChange()}},{key:"renderKeywordSearchBar",value:function(){return u.a.createElement(F.a,{mode:"tags",placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\u3001\u624b\u673a\u53f7\u6216\u90ae\u7bb1",style:{width:"280px",marginRight:"24px"},tokenSeparators:[" "],showArrow:!0,suffixIcon:u.a.createElement(E.a,{style:{fontSize:"16px"},type:"search"}),onChange:this.handleSelectChangeForKeyword,notFoundContent:null})}},{key:"renderDeptSearchBar",value:function(){var e=this.state.deptData;return u.a.createElement("span",null,u.a.createElement("label",null,"\u6240\u5c5e\u79d1\u5ba4\uff1a"),u.a.createElement(F.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"280px"},allowClear:!0,showArrow:!0,onChange:this.handleSelectChangeForDept},e.map(function(e){return u.a.createElement(ve,{key:e.id,value:e.id},e.name)})))}},{key:"renderButtonBar",value:function(){var e=this,t=this.state.selectedRowKeys;return u.a.createElement("div",null,u.a.createElement(b.a,{className:"ele-operation",type:"primary",onClick:function(t){t.preventDefault(),e.props.history.push("".concat(Le,"/add"))}},"\u65b0\u5efa"),u.a.createElement(b.a,{type:"ghost",disabled:t.length<1,onClick:function(){e.handleDeleteOper(t)}},"\u6279\u91cf\u5220\u9664"))}},{key:"buildColumns",value:function(){var e=this;return[{title:"\u5e8f\u53f7",key:"index",render:function(e,t,a){return a+1},onHeaderCell:function(e){return{style:{textAlign:"center",width:"5%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u7528\u6237\u540d",dataIndex:"username",key:"username",onHeaderCell:function(e){return{style:{textAlign:"center"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u624b\u673a",dataIndex:"phone",key:"phone",onHeaderCell:function(e){return{style:{textAlign:"center",width:"12%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u90ae\u7bb1",dataIndex:"email",key:"email",onHeaderCell:function(e){return{style:{textAlign:"center",width:"16%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u79d1\u5ba4",dataIndex:"dept",key:"dept",onHeaderCell:function(e){return{style:{textAlign:"center",width:"10%"}}},onCell:function(e,t){return{style:{textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"}}},render:function(e){return u.a.createElement(oe.a,{placement:"topLeft",title:e?e.name:""},e?e.name:"")}},{title:"\u51bb\u7ed3\u72b6\u6001",dataIndex:"frozen",key:"frozen",render:function(e,t,a){return t.frozen?u.a.createElement("span",{className:"warn-text"},"\u5df2\u51bb\u7ed3"):u.a.createElement("span",{className:"success-text"},"\u6b63\u5e38")},onHeaderCell:function(e){return{style:{textAlign:"center",width:"8%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createTime",key:"createTime",render:function(e,t,a){return ue()(t.createTime).format("YYYY-MM-DD HH:mm:ss")},sorter:function(e,t){return e.id-t.id},onHeaderCell:function(e){return{style:{textAlign:"center",width:"15%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u64cd\u4f5c",key:"operation",render:function(t,a,n){return u.a.createElement("div",null,u.a.createElement(b.a,{type:"link",onClick:function(t){t.preventDefault(),e.props.history.push("".concat(Le,"/edit/").concat(a.id))}},"\u7f16\u8f91"),u.a.createElement(b.a,{type:"link",onClick:function(t){t.preventDefault();var n=a.frozen?"unfreeze":"freeze";Y.post("/user/".concat(n),{ids:[a.id]}).then(function(t){A.a.success("".concat(a.frozen?"\u89e3\u51bb":"\u51bb\u7ed3","\u6210\u529f")),e.handleListChange()}).catch(function(t){e.handleListChange()})}},a.frozen?"\u89e3\u51bb":"\u51bb\u7ed3"),u.a.createElement(b.a,{type:"link",onClick:function(t){t.preventDefault(),e.handleDeleteOper([a.id])}},"\u5220\u9664"))},onHeaderCell:function(e){return{style:{textAlign:"center",width:"18%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}}]}},{key:"renderTable",value:function(){var e=this,t=this.state,a=t.loading,n=t.selectedRowKeys,r=t.data,l=t.pageSize,o=t.current,c=r.total,i=r.content;return a||r.content.length>0?u.a.createElement(le.a,{rowKey:function(e){return e.id},rowSelection:{columnWidth:"30px",selectedRowKeys:n,onChange:function(t){e.setState({selectedRowKeys:t})}},columns:this.buildColumns(),dataSource:i,loading:a,onRow:function(t,a){return{onClick:function(a){a.preventDefault(),"TD"===a.target.tagName&&e.props.history.push("".concat(Le,"/view/").concat(t.id))}}},pagination:{total:c,current:o,pageSize:l,pageSizeOptions:["10","20","50"],showSizeChanger:!0,showTotal:function(e){return"\u5171 ".concat(e," \u6761")}},onChange:function(t,a,n,r){var l=e.state.param,o=t.current,c=t.pageSize,i=n.field,s=n.order;l.sorters={},i&&s&&(l.sorters[de(i)]=function(e){return"descend"===e?"desc":"asc"}(s)),e.setState({current:o,pageSize:c}),e.handleListChange()}}):u.a.createElement(re.a,{description:"\u6682\u65e0\u5185\u5bb9"})}},{key:"render",value:function(){return u.a.createElement(Ee,null,u.a.createElement("div",{className:"list-page"},u.a.createElement("div",{className:"list-page-content"},u.a.createElement(ie.a,{defaultActiveKey:"account",onChange:function(){}},u.a.createElement(be,{tab:"\u79d1\u5ba4",key:"dept"},u.a.createElement(fe,{httpPath:"/dept",modelName:"\u79d1\u5ba4"})),u.a.createElement(be,{tab:"\u8d26\u53f7",key:"account"},u.a.createElement("div",{className:"list-page-content-toolbar"},u.a.createElement("div",{className:"list-page-content-toolbar-search"},this.renderKeywordSearchBar(),this.renderDeptSearchBar()),u.a.createElement("div",{className:"list-page-content-toolbar-button"},this.renderButtonBar())),u.a.createElement("div",{className:"list-page-content-table"},this.renderTable()))))))}}]),t}(u.a.Component);var ke=Object(f.g)(Ce),Oe=(a(131),a(72)),we=(a(521),a(209)),xe=h.a.Content,je=we.a.TreeNode,Se={labelCol:{xs:{span:20},sm:{span:4}},wrapperCol:{xs:{span:20},sm:{span:16}}},De=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).handleCancel=function(e){e.preventDefault(),a.props.history.push("".concat(Le,"/list"))},a.state={loading:!0,data:void 0},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;this.setState({loading:!0},function(){Y.get("/user?id=".concat(t)).then(function(t){var a=t.data.data;e.setState({loading:!1,data:a})}).catch(function(e){})})}},{key:"renderContent",value:function(){var e=this.state,t=e.loading,a=e.data;return!t&&a?u.a.createElement(N.a,Se,u.a.createElement(N.a.Item,{key:"username",label:"\u7528\u6237\u540d"},a.username),u.a.createElement(N.a.Item,{key:"phone",label:"\u624b\u673a"},a.phone),u.a.createElement(N.a.Item,{key:"email",label:"\u90ae\u7bb1"},a.email),u.a.createElement(N.a.Item,{key:"dept",label:"\u79d1\u5ba4"},a.dept&&a.dept.name),u.a.createElement(N.a.Item,{key:"permissions",label:"\u8d26\u53f7\u6388\u6743"},u.a.createElement(we.a,{showLine:!0,defaultExpandAll:!0},a.permissions.map(function(e){return u.a.createElement(je,{title:e.name})})))):u.a.createElement(Oe.a,{size:"large"})}},{key:"render",value:function(){var e=this,t=this.props.match.params.id;return u.a.createElement(xe,null,u.a.createElement("div",{style:{margin:"4px 4px 10px",display:"flex",alignItems:"center"}},u.a.createElement("div",{style:{margin:"4px",flex:1}},u.a.createElement("span",{style:{float:"right"}},u.a.createElement(b.a,{className:"ele-operation",type:"primary",onClick:function(a){a.preventDefault(),e.props.history.push("".concat(Le,"/edit/").concat(t))}},"\u7f16\u8f91"),u.a.createElement(b.a,{type:"default",onClick:this.handleCancel},"\u8fd4\u56de")))),u.a.createElement("div",{style:{margin:"8px"}},this.renderContent()))}}]),t}(u.a.Component),Ie=Object(f.g)(De),Te=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e,t=this,a=this.props.location.pathname;return a.indexOf("".concat(Le,"/add"))>=0?e="\u65b0\u589e":a.indexOf("".concat(Le,"/edit"))>=0?e="\u7f16\u8f91":a.indexOf("".concat(Le,"/view"))>=0?e="\u8be6\u60c5":a.indexOf("".concat(Le,"/list"))>=0&&(e="\u67e5\u8be2"),u.a.createElement("div",{className:"layout-content"},u.a.createElement("div",{className:"layout-content-inner"},u.a.createElement(x.a,null,u.a.createElement(x.a.Item,null,"\u5f53\u524d\u4f4d\u7f6e\uff1a"),u.a.createElement(x.a.Item,null,"\u8d26\u53f7\u4e0e\u5b89\u5168"),u.a.createElement(x.a.Item,{onClick:function(){return t.props.history.push("".concat(Le))}},"\u8d26\u53f7\u7ba1\u7406"),u.a.createElement(x.a.Item,null,e)),u.a.createElement(p.a,null,u.a.createElement(f.d,null,u.a.createElement(f.a,{path:"".concat(Le),exact:!0,to:"".concat(Le,"/list")}),u.a.createElement(f.b,{path:"".concat(Le,"/list"),component:ke}),u.a.createElement(f.b,{path:"".concat(Le,"/add"),component:V}),u.a.createElement(f.b,{path:"".concat(Le,"/edit/:id"),component:Q}),u.a.createElement(f.b,{path:"".concat(Le,"/view/:id"),component:Ie})))))}}]),t}(u.a.Component),Ne=Object(f.g)(Te),Ae=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return u.a.createElement("div",{className:"layout-content"},u.a.createElement("div",{className:"layout-content-aside"}),u.a.createElement("div",{className:"layout-content-inner"}))}}]),t}(u.a.Component),Fe="/main/user",Le="".concat(Fe,"/manage"),ze=("".concat(Fe,"/authority"),h.a.Sider),Pe=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).state={collapsed:!1,selectedKeys:[]},a.handleOnSelect=function(e){var t=e.key;a.setState({selectedKeys:[t]}),a.props.history.push("".concat(Fe).concat(t))},a.toggleCollapsed=function(){a.setState({collapsed:!a.state.collapsed})},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.handleOnSelect({key:"/manage"})}},{key:"render",value:function(){var e=this.state.selectedKeys;return u.a.createElement(h.a,null,u.a.createElement(ze,{width:180,theme:"dark",collapsed:this.state.collapsed,collapsedWidth:80},u.a.createElement("span",{className:"aside-top",onClick:this.toggleCollapsed},u.a.createElement(E.a,{style:{margin:"0 0 0 10px"},type:this.state.collapsed?"menu-unfold":"menu-fold"})),u.a.createElement(v.b,{selectedKeys:e,mode:"inline",theme:"dark",onSelect:this.handleOnSelect},u.a.createElement(v.b.Item,{className:"aside-item",key:"/manage"},u.a.createElement(E.a,{type:"solution"}),u.a.createElement("span",null,"\u8d26\u53f7\u7ba1\u7406")),u.a.createElement(v.b.Item,{className:"aside-item",key:"/authority"},u.a.createElement(E.a,{type:"safety-certificate"}),u.a.createElement("span",null,"\u6388\u6743\u67e5\u8be2")))),u.a.createElement(h.a,null,u.a.createElement(p.a,null,u.a.createElement(f.d,null,u.a.createElement(f.b,{path:"".concat(Fe,"/manage"),component:Ne}),u.a.createElement(f.b,{path:"".concat(Fe,"/authority"),component:Ae})))))}}]),t}(u.a.Component),Me=Object(f.g)(Pe),Be=(a(523),a(298)),Ye=a(168),Re=function(e){var t=e.component,a=Object(Ye.a)(e,["component"]);return u.a.createElement(ma.Consumer,null,function(e){var n=a.permission,r=e.permissions,l=n?r.find(function(e){return n instanceof Array?n.find(function(t){return e.id===t}):e.id===n}):"true";return u.a.createElement(f.b,Object.assign({},a,{render:function(e){return sessionStorage.getItem("userId")?l?u.a.createElement(t,null):u.a.createElement(Be.a,{style:{width:"100%",height:"100%"},status:"403",title:"403",subTitle:"\u6ca1\u6709\u8bbf\u95ee\u6743\u9650"}):u.a.createElement(f.a,{to:{pathname:"/login",state:{from:e.location.pathname}}})}}))})},Ke=(a(525),h.a.Content),He=F.a.Option,_e=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).handleListChange=function(){a.setState({loading:!0},function(){var e=a.state,t=e.pageSize,n=e.current,r=e.param,l=Object(y.a)({pageSize:t,current:n},r);Y.post("/docm/list",l).then(function(e){a.setState({loading:!1,data:e.data.data})}).catch(function(e){a.setState({loading:!1})})})},a.loadProjectTypes=function(){Y.get("/docm/type/list").then(function(e){a.setState({projectTypes:e.data.data})}).catch(function(e){A.a.error("\u52a0\u8f7d\u9879\u76ee\u7c7b\u578b\u6570\u636e\u5931\u8d25")})},a.loadDeptData=function(){a.setState({loading:!0},function(){Y.post("/dept/list-all").then(function(e){a.setState({loading:!1,deptData:e.data.data})}).catch(function(e){a.setState({loading:!1})})})},a.handleSelectChangeForKeyword=function(e){a.state.param.conditions.keywords=e,a.setState({current:1}),a.handleListChange()},a.handleSelectChangeForProjectType=function(e){a.state.param.conditions.projectType=e,a.setState({current:1}),a.handleListChange()},a.handleSelectChangeForDept=function(e){a.state.param.conditions.dept={id:e},a.setState({current:1}),a.handleListChange()},a.handleDeleteOper=function(){var e=Object(D.a)(S.a.mark(function e(t){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:ce.a.confirm({title:"\u786e\u5b9a\u5220\u9664?",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){var e=Object(D.a)(S.a.mark(function e(){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="",t.forEach(function(e){return n=n.concat("ids=".concat(e,"&"))}),e.next=4,Y.delete("/docm?".concat(n.substring(0,n.length-1)));case 4:A.a.success("\u5220\u9664\u6210\u529f"),a.handleListChange();case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.state={loading:!0,selectedRowKeys:[],projectTypes:[],data:{total:void 0,content:[]},pageSize:10,current:1,param:{conditions:{},sorters:{}},deptData:[]},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.loadProjectTypes(),this.loadDeptData(),this.handleListChange()}},{key:"renderKeywordSearchBar",value:function(){return u.a.createElement(F.a,{mode:"tags",placeholder:"\u641c\u7d22\u5408\u540c\u540d\u79f0\u3001\u516c\u53f8\u540d\u79f0\u6216\u91d1\u989d",style:{width:"280px",marginRight:"24px"},tokenSeparators:[" "],showArrow:!0,suffixIcon:u.a.createElement(E.a,{style:{fontSize:"16px"},type:"search"}),onChange:this.handleSelectChangeForKeyword,notFoundContent:null})}},{key:"renderProjectTypeSearchBar",value:function(){var e=this.state.projectTypes;return u.a.createElement("span",null,u.a.createElement("label",null,"\u5408\u540c\u7c7b\u578b\uff1a"),u.a.createElement(F.a,{placeholder:"\u8bf7\u9009\u62e9\u5408\u540c\u7c7b\u578b",style:{width:"280px",marginRight:"24px"},allowClear:!0,showArrow:!0,onChange:this.handleSelectChangeForProjectType,notFoundContent:"\u6682\u65e0\u6570\u636e"},e.map(function(e){return u.a.createElement(He,{key:e,value:e},e)})))}},{key:"renderDeptSearchBar",value:function(){var e=this.state.deptData;return u.a.createElement("span",null,u.a.createElement("label",null,"\u6240\u5c5e\u79d1\u5ba4\uff1a"),u.a.createElement(F.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"280px",marginRight:"24px"},allowClear:!0,showArrow:!0,onChange:this.handleSelectChangeForDept},e.map(function(e){return u.a.createElement(He,{key:e.id,value:e.id},e.name)})))}},{key:"renderButtonBar",value:function(){var e=this,t=this.state.selectedRowKeys;return u.a.createElement(ma.Consumer,null,function(a){var n=a.permissions.find(function(e){return"DOCM_ADD_OPER"===e.id}),r=a.permissions.find(function(e){return"DOCM_DELETE_OPER"===e.id});return u.a.createElement("div",{style:{margin:"4px",flex:1}},u.a.createElement("span",{style:{float:"right"}},n&&u.a.createElement(b.a,{className:"ele-operation",type:"primary",onClick:function(){e.props.history.push("".concat(wt,"/add"))}},"\u65b0\u5efa"),r&&u.a.createElement(b.a,{type:"ghost",disabled:t.length<1,onClick:function(){e.handleDeleteOper(t)}},"\u6279\u91cf\u5220\u9664")))})}},{key:"buildColumns",value:function(){var e=this;return[{title:"\u5e8f\u53f7",key:"index",render:function(e,t,a){return a+1},onHeaderCell:function(e){return{style:{textAlign:"center",width:"5%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u5408\u540c\u540d\u79f0",dataIndex:"projectName",key:"projectName",sorter:function(e,t){return e.id-t.id},onHeaderCell:function(e){return{style:{textAlign:"center"}}},onCell:function(e,t){return{style:{textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"}}},render:function(e){return u.a.createElement(oe.a,{placement:"topLeft",title:e},e)}},{title:"\u5408\u540c\u7c7b\u578b",dataIndex:"projectType",key:"projectType",sorter:function(e,t){return e.id-t.id},onHeaderCell:function(e){return{style:{textAlign:"center",width:"10%"}}},onCell:function(e,t){return{style:{textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"}}},render:function(e){return u.a.createElement(oe.a,{placement:"topLeft",title:e},e)}},{title:"\u516c\u53f8\u540d\u79f0",dataIndex:"company",key:"company",sorter:function(e,t){return e.id-t.id},onHeaderCell:function(e){return{style:{textAlign:"center",width:"10%"}}},onCell:function(e,t){return{style:{textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"}}},render:function(e){return u.a.createElement(oe.a,{placement:"topLeft",title:e},e)}},{title:"\u5408\u540c\u53f7",dataIndex:"contractNum",key:"contractNum",sorter:function(e,t){return e.id-t.id},onHeaderCell:function(e){return{style:{textAlign:"center",width:"10%"}}},onCell:function(e,t){return{style:{textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"}}},render:function(e){return u.a.createElement(oe.a,{placement:"topLeft",title:e},e)}},{title:"\u79d1\u5ba4",dataIndex:"dept",key:"dept",onHeaderCell:function(e){return{style:{textAlign:"center",width:"6%"}}},onCell:function(e,t){return{style:{textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"}}},render:function(e){return u.a.createElement(oe.a,{placement:"topLeft",title:e?e.name:""},e?e.name:"")}},{title:"\u603b\u91d1\u989d",dataIndex:"money",key:"money",sorter:function(e,t){return e.id-t.id},onHeaderCell:function(e){return{style:{textAlign:"center",width:"15%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createTime",key:"createTime",render:function(e,t,a){return ue()(t.createTime).format("YYYY-MM-DD HH:mm:ss")},sorter:function(e,t){return e.id-t.id},onHeaderCell:function(e){return{style:{textAlign:"center",width:"12%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u64cd\u4f5c",key:"operation",render:function(t,a,n){return u.a.createElement(ma.Consumer,null,function(t){var n=t.permissions.find(function(e){return"DOCM_EDIT_OPER"===e.id}),r=t.permissions.find(function(e){return"DOCM_DELETE_OPER"===e.id}),l=t.permissions.find(function(e){return"DOCM_DOWNLOAD_OPER"===e.id});return u.a.createElement("div",null,n&&u.a.createElement(b.a,{type:"link",onClick:function(t){t.preventDefault(),e.props.history.push("".concat(wt,"/edit/").concat(a.id))}},"\u7f16\u8f91"),l&&u.a.createElement(b.a,{type:"link",href:"".concat(M,"/doc?id=").concat(a.id,"&xAuthToken=").concat(sessionStorage.getItem("xAuthToken")),target:"_blank"},"\u4e0b\u8f7d"),r&&u.a.createElement(b.a,{type:"link",onClick:function(){return e.handleDeleteOper([a.id])}},"\u5220\u9664"))})},onHeaderCell:function(e){return{style:{textAlign:"center",width:"16%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}}]}},{key:"renderTable",value:function(){var e=this,t=this.state,a=t.loading,n=t.data,r=t.pageSize,l=t.current,o=t.selectedRowKeys;return u.a.createElement(ma.Consumer,null,function(t){var c=t.permissions.find(function(e){return"DOCM_DELETE_OPER"===e.id})?{columnWidth:"30px",selectedRowKeys:o,onChange:function(t){e.setState({selectedRowKeys:t})}}:void 0;return!a&&n&&n.content.length>0?u.a.createElement(le.a,{rowKey:function(e){return e.id},rowSelection:c,columns:e.buildColumns(),dataSource:n.content,loading:a,onRow:function(t,a){return{onClick:function(a){"TD"===a.target.tagName&&e.props.history.push("".concat(wt,"/view/").concat(t.id))}}},size:"default",pagination:{total:n.total,current:l,pageSize:r,pageSizeOptions:["10","20","50"],showSizeChanger:!0,onShowSizeChange:function(t,a){e.setState({current:1,pageSize:a})},showTotal:function(e){return"\u5171 ".concat(e," \u6761")}},onChange:function(t,a,n,r){var l=e.state.param,o=t.current,c=t.pageSize,i=n.field,s=n.order;l.sorters={},i&&s&&(l.sorters[de(i)]=function(e){return"descend"===e?"desc":"asc"}(s)),e.setState({current:o,pageSize:c}),e.handleListChange()}}):u.a.createElement(re.a,{description:"\u6682\u65e0\u5185\u5bb9"})})}},{key:"render",value:function(){return u.a.createElement(Ke,null,u.a.createElement("div",{className:"list-page"},u.a.createElement("div",{className:"list-page-content"},u.a.createElement("div",{className:"list-page-content-toolbar"},u.a.createElement("div",{className:"list-page-content-toolbar-search"},this.renderKeywordSearchBar(),this.renderProjectTypeSearchBar(),this.renderDeptSearchBar()),u.a.createElement("div",{className:"list-page-content-toolbar-button"},this.renderButtonBar())),u.a.createElement("div",{className:"list-page-content-table"},this.renderTable()))))}}]),t}(u.a.Component);var qe=Object(f.g)(_e),Ve=(a(526),a(292)),Ue=(a(266),a(167)),We=a(157),$e=(a(529),a(211)),Ge=(a(531),a(296)),Ze=a(299),Je=a(208),Xe=a.n(Je),Qe={xs:{span:24},md:{span:12}},et={labelCol:{xs:{span:6},md:{span:4}},wrapperCol:{xs:{span:12},md:{span:18}}},tt={labelCol:{xs:{span:6},md:{span:2}},wrapperCol:{xs:{span:12},md:{span:21}}},at={onHeaderCell:function(e){return{style:{textAlign:"center",width:"10%"}}},onCell:function(e,t){return{style:{textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}},render:function(e){return e&&u.a.createElement(oe.a,{placement:"topLeft",title:e},e)}},nt=(a(277),a(165)),rt=(a(153),a(39)),lt=(a(154),a(26)),ot=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).onChange=function(e){var t=e.target.value,n=a.props.onChange;(!Number.isNaN(t)&&/^-?(0|[1-9][0-9]*)(\.[0-9]*)?$/.test(t)||""===t||"-"===t)&&n&&n(t)},a.onBlur=function(){var e=a.props,t=e.value,n=e.onBlur,r=e.onChange;!t||"."!==t.charAt(t.length-1)&&"-"!==t||r&&r({value:t.slice(0,-1)}),n&&n()},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return u.a.createElement(I.a,Object.assign({},this.props,{onChange:this.onChange,onBlur:this.onBlur,maxLength:25}))}}]),t}(u.a.Component),ct=F.a.Option,it=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).state={value:e.value?e.value.id:void 0,deptData:[]},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;Y.post("/dept/list-all").then(function(t){e.setState({deptData:t.data.data})}).catch(function(e){})}},{key:"handleOnChange",value:function(e){var t=this.props.onChange,a=this.state.deptData.find(function(t){return t.id===e});t&&t(a),this.setState({value:e})}},{key:"render",value:function(){var e=this.state,t=e.deptData,a=e.value;return u.a.createElement(F.a,{style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9",value:a,showSearch:!0,allowClear:!0,onChange:this.handleOnChange.bind(this),filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},t.map(function(e){return u.a.createElement(ct,{key:e.id,value:e.id},e.name)}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.value){if(!t.value)return{value:e.value.id};if(e.value.id!==t.value.id)return{value:e.value.id}}return null}}]),t}(u.a.Component),st=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).state={deptData:[]},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return e("id"),e("attachments"),u.a.createElement(N.a,et,u.a.createElement(rt.a,{gutter:10},u.a.createElement(lt.a,Qe,u.a.createElement(N.a.Item,{key:"projectName",label:"\u5408\u540c\u540d\u79f0"},e("projectName",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5408\u540c\u540d\u79f0"},{max:10,message:"\u540d\u79f0\u8fc7\u957f"}]})(u.a.createElement(I.a,null)))),u.a.createElement(lt.a,Qe,u.a.createElement(N.a.Item,{key:"dept",label:"\u6240\u5c5e\u79d1\u5ba4"},e("dept")(u.a.createElement(it,null))))),u.a.createElement(rt.a,{gutter:10},u.a.createElement(lt.a,Qe,u.a.createElement(N.a.Item,{key:"company",label:"\u4e59\u65b9\u540d\u79f0"},e("company",{rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u4e59\u65b9\u540d\u79f0"}]})(u.a.createElement(I.a,null)))),u.a.createElement(lt.a,Qe,u.a.createElement(N.a.Item,{key:"projectType",label:"\u5408\u540c\u7c7b\u578b"},e("projectType",{rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u5408\u540c\u7c7b\u578b"}]})(u.a.createElement(I.a,null))))),u.a.createElement(rt.a,{gutter:10},u.a.createElement(lt.a,Qe,u.a.createElement(N.a.Item,{key:"contractNum",label:"\u4e2d\u6807\u7f16\u53f7"},e("contractNum",{rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u5408\u540c\u53f7"}]})(u.a.createElement(I.a,null)))),u.a.createElement(lt.a,Qe,u.a.createElement(N.a.Item,{key:"contractTime",label:"\u5408\u540c\u7b7e\u8ba2\u65f6\u95f4"},e("contractTime")(u.a.createElement(nt.a,{style:{width:"100%"},format:"YYYY-MM-DD"}))))),u.a.createElement(rt.a,{gutter:10},u.a.createElement(lt.a,Qe,u.a.createElement(N.a.Item,{key:"money",label:"\u91d1\u989d"},e("money",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u5408\u540c\u91d1\u989d"}]})(u.a.createElement(ot,{onChange:function(e){console.log(e)},tips:"\u8bf7\u8f93\u5165\u5408\u540c\u91d1\u989d"})))),u.a.createElement(lt.a,Qe,u.a.createElement(N.a.Item,{key:"description",label:"\u5907\u6ce8"},e("description",{rules:[{max:500,message:"\u4e0d\u80fd\u8d85\u8fc7500\u5b57\u7b26"}]})(u.a.createElement(I.a.TextArea,null))))))}}]),t}(s.Component),ut=N.a.create()(st),dt=(a(536),h.a.Content),mt=Ge.a.Dragger,pt=$e.a.Meta,ft=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).editForm=void 0,a.findToolBarElement=function(){var e=Xe()("section.ant-layout");if(3===e.length)return e[2]},a.addToolBarScrollEventListener=function(){var e=a.findToolBarElement();e&&e.addEventListener("scroll",a.handlerScroll.bind(Object(We.a)(a),e))},a.removeToolBarScrollEventListener=function(){var e=a.findToolBarElement();e&&e.removeEventListener("scroll",function(){console.log("\u79fb\u9664\u6210\u529f")})},a.handleCancel=function(e){e.preventDefault(),a.props.history.push("".concat(wt,"/list"))},a.handleSubmit=function(e){e.preventDefault(),a.editForm&&a.editForm.props.form.validateFields(function(e,t){if(!e){var n=a.state.fileList,r=Object(y.a)({},t,{contractTime:t.contractTime?t.contractTime.format("YYYY-MM-DD"):void 0,credentialTime:t.credentialTime?t.credentialTime.format("YYYY-MM"):void 0,attachments:n.filter(function(e){return"done"===e.status}).map(function(e){return{docPath:e.docPath,docName:e.docName,type:e.type,size:e.size,md5:e.md5}})}),l=a.state.mode,o="add"===l?Y.put:"edit"===l?Y.post:void 0;o&&o("/docm",r).then(function(e){"00000000"===e.data.status?a.props.history.push("".concat(wt,"/list")):A.a.error(e.data.message)}).catch(function(e){A.a.info(e.response.data.msg)})}})},a.updateFileUploadByResponse=function(e,t){var n=a.state.fileList,r=n.find(function(t){return t.uid===e});r&&Object.assign(r,t),a.setState({fileList:n})},a.updateFileUploadStatus=function(e,t){var n=a.state.fileList,r=n.find(function(t){return t.uid===e});r&&(r.status=t),a.setState({fileList:n})},a.updateFileUploadProgress=function(e,t){var n=a.state.fileList,r=n.find(function(t){return t.uid===e});r&&(r.percent=t),a.setState({fileList:n})},a.addFileUpload=function(e){var t=a.state.fileList;t=t.concat({uid:e.uid,size:e.size,name:e.name,type:e.type,status:"uploading",docName:"",docPath:"",md5:""}),a.setState({fileList:t})},a.handleCustomUpload=function(e){var t=e.file;a.addFileUpload(t);var n=new FormData;n.append("files",t),Xe.a.ajax({url:"".concat(M,"/doc?xAuthToken=").concat(sessionStorage.getItem("xAuthToken")),type:"POST",data:n,dataType:"json",processData:!1,contentType:!1,timeout:6e4,beforeSend:function(){console.log("\u51c6\u5907\u4e0a\u4f20.")},xhr:function(){var e=new XMLHttpRequest;return e.upload&&(e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var n=Math.floor(e.loaded/e.total*100);a.updateFileUploadProgress(t.uid,n)}},!1),e.upload.addEventListener("load",function(e){},!1)),e},success:function(e){var n=e.data[0],r=(n.name,Object(Ye.a)(n,["name"]));console.log(r),"00000000"===e.status&&e.data&&a.updateFileUploadByResponse(t.uid,r),setTimeout(function(){a.updateFileUploadStatus(t.uid,"done")},1500)},error:function(e){403===e.status?A.a.error("\u60a8\u6ca1\u6709\u4e0a\u4f20\u6743\u9650"):A.a.error("".concat(t.name," \u4e0a\u4f20\u5931\u8d25"))}})},a.renderForm=function(){var e=a.state,t=e.fileList,n=e.appConf.uploadFileMaxAmount;return u.a.createElement("div",null,u.a.createElement(ut,{wrappedComponentRef:function(e){return a.editForm=e}}),u.a.createElement(N.a,et,u.a.createElement(N.a.Item,Object.assign({},tt,{key:"upload",label:"\u9644\u4ef6"}),t.length>=n?null:u.a.createElement(mt,{name:"files",multiple:!0,showUploadList:!1,customRequest:a.handleCustomUpload},u.a.createElement("p",{className:"ant-upload-drag-icon"},u.a.createElement(E.a,{type:"inbox"})),u.a.createElement("p",{className:"ant-upload-text"},"\u70b9\u51fb\u6216\u62d6\u62fd\u6587\u4ef6\u5230\u6b64\u533a\u57df\u4e0a\u4f20"),u.a.createElement("p",{className:"ant-upload-hint"},"\u4ec5\u652f\u6301\u4e00\u6b21\u6027\u5355\u4e2a\u6587\u4ef6\uff0c\u4e14\u6587\u4ef6\u7c7b\u578b\u4e3apdf")),a.showAttachmentList())))},a.state={mode:void 0,appConf:{uploadFileMaxAmount:5},loading:!0,data:void 0,fileList:[],deptData:[],selectedDept:void 0,percent:0,needFixed:!1},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.initData(),this.addToolBarScrollEventListener()}},{key:"componentWillUnmount",value:function(){this.removeToolBarScrollEventListener()}},{key:"initData",value:function(){var e=this,t=this.props.match.params.id,a=t?"edit":"add";this.setState({mode:a,loading:!0},function(){"edit"===a?Y.get("/docm?id=".concat(t)).then(function(t){var a=t.data.data;e.editForm&&e.editForm.props.form.setFieldsValue(Object(y.a)({},a,{contractTime:a.contractTime?ue()(a.contractTime,"YYYY-MM-DD"):void 0,credentialTime:a.credentialTime?ue()(a.credentialTime,"YYYY-MM"):void 0}));var n=a.attachments.map(function(e){return{uid:e.id,name:e.docName,docName:e.docName,docPath:e.docPath,type:e.type,size:e.size,status:"done"}});e.setState({loading:!1,data:a,fileList:n,selectedDept:a.dept})}).catch(function(e){}):"add"===a&&(e.editForm&&e.editForm.props.form.setFieldsValue({attachments:[]}),e.setState({loading:!1})),Y.post("/dept/list-all").then(function(t){e.setState({deptData:t.data.data})}).catch(function(e){})})}},{key:"handlerScroll",value:function(e){var t=e.offsetTop,a=e.scrollTop;a>=t?this.setState({needFixed:!0}):a<t&&this.setState({needFixed:!1})}},{key:"showAttachmentList",value:function(){var e=this;return this.state.fileList.map(function(t){return u.a.createElement($e.a,{key:t.uid,size:"small",style:{marginTop:"8px"}},u.a.createElement(pt,{title:u.a.createElement("div",null,u.a.createElement("div",{style:{display:"flex"}},u.a.createElement("p",{style:{flexGrow:1,overflow:"hidden",width:"200px"}},t.name),u.a.createElement("div",{style:{flexGrow:.1}},u.a.createElement(b.a,{type:"link",style:{float:"right",color:"gray"},onClick:function(){for(var a=e.state.fileList,n=a.length,r=0;r<n;r++)if(a[r].uid===t.uid){a.splice(r,1);break}e.setState({fileList:a})}},u.a.createElement(E.a,{type:"delete"})))),u.a.createElement("div",{style:{color:"gray"}},"".concat(t.size," Byte")),"done"!==t.status&&u.a.createElement(Ue.a,{percent:t.percent})),avatar:u.a.createElement(Ve.a,{shape:"square",size:"large",icon:"file"})}))})}},{key:"render",value:function(){var e=this.state.mode;return u.a.createElement(dt,null,u.a.createElement("div",{className:"tool-bar ".concat(this.state.needFixed?"fixed":"")},u.a.createElement("div",{className:"tool-bar-item"}),u.a.createElement("div",{className:"tool-bar-item"}),u.a.createElement("div",{className:"tool-bar-item"},u.a.createElement("div",{className:"tool-bar",style:{float:"right"}},u.a.createElement("div",{className:"tool-bar-item"},u.a.createElement(b.a,{block:!0,type:"primary",onClick:this.handleSubmit},"add"===e?"\u63d0\u4ea4":"\u4fdd\u5b58")),u.a.createElement("div",{className:"tool-bar-item"},u.a.createElement(b.a,{type:"default",onClick:this.handleCancel},"\u8fd4\u56de"))))),u.a.createElement("div",{style:{margin:"8px"}},this.renderForm()))}}]),t}(u.a.Component),ht=Object(Ze.a)({name:"form"})(ft),yt=Object(f.g)(ht),gt=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return e("id"),u.a.createElement(N.a,et,u.a.createElement(N.a.Item,{key:"order",label:"\u5e8f\u53f7"},e("order",{rules:[{required:!0,message:"\u5e8f\u53f7\u4e0d\u80fd\u4e3a\u7a7a"}]})(u.a.createElement(I.a,null))),u.a.createElement(N.a.Item,{key:"money",label:"\u91d1\u989d"},e("money",{rules:[{required:!0,message:"\u91d1\u989d\u4e0d\u80fd\u4e3a\u7a7a"}]})(u.a.createElement(ot,null))),u.a.createElement(N.a.Item,{key:"credentialNum",label:"\u51ed\u8bc1\u53f7"},e("credentialNum",{rules:[{max:32,message:"\u51ed\u8bc1\u53f7\u8fc7\u957f"}]})(u.a.createElement(I.a,null))),u.a.createElement(N.a.Item,{key:"credentialTime",label:"\u51ed\u8bc1\u65f6\u95f4"},e("credentialTime")(u.a.createElement(nt.a,{style:{width:"100%"},format:"YYYY-MM-DD"}))),u.a.createElement(N.a.Item,{key:"desc",label:"\u5907\u6ce8"},e("desc",{rules:[{max:500,message:"\u5907\u6ce8\u8fc7\u957f"}]})(u.a.createElement(I.a.TextArea,null))))}}]),t}(s.Component),Et=N.a.create()(gt),vt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).form=void 0,a.state={data:void 0},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.setValue()}},{key:"setValue",value:function(){var e=this.state.data;if(this.form){var t=this.form.props.form,a=t.setFieldsValue,n=t.resetFields;e?a(Object(y.a)({},e)):n()}}},{key:"render",value:function(){var e=this;return this.setValue(),u.a.createElement(N.a,et,u.a.createElement(Et,{wrappedComponentRef:function(t){e.form=t,e.props.wrappedComponentRef(t)}}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){return{data:e.data}}}]),t}(s.Component),bt=(a(575),h.a.Content),Ct=Object(y.a)({},Qe,{style:{height:"48px"}}),kt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).goBack=function(e){e.preventDefault(),a.props.history.push("".concat(wt,"/list"))},a.handleDeletePayItem=function(e){ce.a.confirm({title:"\u786e\u5b9a\u5220\u9664?",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){var t=Object(D.a)(S.a.mark(function t(){var n;return S.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n="",e.forEach(function(e){return n=n.concat("ids=".concat(e,"&"))}),Y.delete("/docm/pay-item?".concat(n.substring(0,n.length-1))).then(function(e){A.a.success("\u5220\u9664\u6210\u529f"),a.refreshPage()}).catch(function(e){});case 3:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()})},a.form=void 0,a.handleSubmit=function(){a.form&&a.form.props.form.validateFields(function(e,t){var n;e||(n=a.state.payItem?Y.post:Y.put,Object.assign(t,{contractId:a.state.data.id}),n("/docm/pay-item",t).then(function(e){"00000000"===e.data.status?(a.refreshPage(),A.a.success("\u64cd\u4f5c\u6210\u529f")):A.a.error(e.data.message)}).catch(function(e){A.a.info(e.response.data.msg)}))})},a.handleCancel=function(){a.setState({showPayItemForm:!1})},a.state={loading:!0,data:{},fileList:[],attachmentId:void 0,showPayItemForm:!1,payItem:void 0},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.refreshPage()}},{key:"refreshPage",value:function(){var e=this,t=this.props.match.params.id;this.setState({loading:!0,showPayItemForm:!1},function(){Y.get("/docm?id=".concat(t)).then(function(t){var a=t.data.data,n=a.attachments.map(function(e){return{uid:e.id,size:123,name:e.docName,type:"image",status:"done",response:{status:"00000000",data:[{docName:e.docName,docPath:e.docPath}]}}});e.setState({loading:!1,data:a,fileList:n})}).catch(function(e){})})}},{key:"renderToolBar",value:function(){var e=this;return u.a.createElement("div",{style:{margin:"4px",flex:1}},u.a.createElement("span",{style:{float:"right"}},u.a.createElement(b.a,{className:"ele-operation",type:"primary",onClick:function(t){t.preventDefault();var a=e.props.match.params.id;e.props.history.push("".concat(wt,"/edit/").concat(a))}},"\u7f16\u8f91"),u.a.createElement(b.a,{type:"default",onClick:this.goBack},"\u8fd4\u56de")))}},{key:"renderContent",value:function(){var e=this.state,t=e.loading,a=e.data,n=e.fileList;return!t&&a?u.a.createElement(N.a,et,u.a.createElement(rt.a,{gutter:10},u.a.createElement(lt.a,Ct,u.a.createElement(N.a.Item,{key:"projectName",label:"\u5408\u540c\u540d\u79f0"},a.projectName)),u.a.createElement(lt.a,Ct,u.a.createElement(N.a.Item,{key:"dept",label:"\u6240\u5c5e\u79d1\u5ba4"},a.dept?a.dept.name:""))),u.a.createElement(rt.a,{gutter:10},u.a.createElement(lt.a,Ct,u.a.createElement(N.a.Item,{key:"company",label:"\u4e59\u65b9\u540d\u79f0"},a.company)),u.a.createElement(lt.a,Ct,u.a.createElement(N.a.Item,{key:"projectType",label:"\u5408\u540c\u7c7b\u578b"},a.projectType))),u.a.createElement(rt.a,{gutter:10},u.a.createElement(lt.a,Ct,u.a.createElement(N.a.Item,{key:"contractNum",label:"\u4e2d\u6807\u7f16\u53f7"},a.contractNum)),u.a.createElement(lt.a,Ct,u.a.createElement(N.a.Item,{key:"contractTime",label:"\u5408\u540c\u7b7e\u8ba2\u65f6\u95f4"},a.contractTime))),u.a.createElement(rt.a,{gutter:10},u.a.createElement(lt.a,Ct,u.a.createElement(N.a.Item,{key:"money",label:"\u91d1\u989d"},a.money)),u.a.createElement(lt.a,Ct,u.a.createElement(N.a.Item,{key:"description",label:"\u5907\u6ce8"},a.desc))),u.a.createElement(N.a.Item,Object.assign({},tt,{key:"upload",label:"\u9644\u4ef6"}),n.map(function(e){return u.a.createElement("div",null,u.a.createElement(b.a,{key:e.uid,id:e.uid,icon:"paper-clip",type:"link",href:"".concat(M,"/doc/pre-view?id=").concat(e.uid,"&xAuthToken=").concat(sessionStorage.getItem("xAuthToken"))},e.name))}))):u.a.createElement(Oe.a,{size:"large"})}},{key:"renderPayItem",value:function(){var e=this,t=this.state,a=t.loading,n=t.data,r=t.data.payItems,l=[Object(y.a)({},at,{title:"\u5e8f\u53f7",dataIndex:"order",key:"order",onHeaderCell:function(e){return{style:{textAlign:"center",width:"3%"}}}}),Object(y.a)({},at,{title:"\u91d1\u989d",dataIndex:"money",key:"money"}),Object(y.a)({},at,{title:"\u51ed\u8bc1\u53f7",dataIndex:"credentialNum",key:"credentialNum"}),Object(y.a)({},at,{title:"\u51ed\u8bc1\u65f6\u95f4",dataIndex:"credentialTime",key:"credentialTime"}),Object(y.a)({},at,{title:"\u5907\u6ce8",dataIndex:"desc",key:"desc"}),Object(y.a)({},at,{title:"\u64cd\u4f5c",dataIndex:"operation",key:"operation",render:function(t,a){return u.a.createElement("div",null,u.a.createElement(b.a,{type:"link",onClick:function(t){e.setState({showPayItemForm:!0,payItem:a})}},"\u7f16\u8f91"),u.a.createElement(b.a,{type:"link",onClick:e.handleDeletePayItem.bind(e,[a.id])},"\u5220\u9664"))}})],o=0;return r&&r.forEach(function(e){return o+=e.money}),a?u.a.createElement(Oe.a,{size:"large"}):u.a.createElement(le.a,{columns:l,dataSource:r,size:"small",bordered:!0,pagination:!1,title:function(){return u.a.createElement("div",{style:{display:"flex",alignItems:"center"}},u.a.createElement("div",{style:{flex:1}},u.a.createElement("h2",null,"\u4ed8\u6b3e\u9879")),u.a.createElement("div",{style:{flex:1}},u.a.createElement("h4",null,"\u5408\u8ba1\uff1a".concat(o))),u.a.createElement("div",{style:{flex:1}},u.a.createElement("h4",null,"\u767e\u5206\u6bd4\uff1a".concat((Math.round(100*o/n.money*100)/100).toFixed(2),"%"))),u.a.createElement("div",{style:{flex:1}},u.a.createElement(b.a,{style:{float:"right"},type:"ghost",onClick:function(){e.setState({showPayItemForm:!0,payItem:void 0})}},"\u6dfb\u52a0")))}})}},{key:"renderPayItemModal",value:function(){var e=this,t=this.state,a=t.showPayItemForm,n=t.payItem;return u.a.createElement(ce.a,{title:"\u6dfb\u52a0\u4ed8\u6b3e\u9879",visible:a,onCancel:this.handleCancel,onOk:this.handleSubmit},u.a.createElement(vt,{data:n,wrappedComponentRef:function(t){return e.form=t}}))}},{key:"render",value:function(){return u.a.createElement(bt,null,u.a.createElement("div",{style:{margin:"4px 4px 10px",display:"flex",alignItems:"center"}},this.renderToolBar()),u.a.createElement("div",{style:{margin:"8px"}},this.renderContent(),this.renderPayItem()),u.a.createElement("div",null,this.renderPayItemModal()))}}]),t}(u.a.Component),Ot=Object(f.g)(kt),wt="/main/docm",xt=h.a.Sider,jt=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e,t=this,a=this.props.location.pathname;return a.indexOf("".concat(wt,"/add"))>=0?e="\u65b0\u589e":a.indexOf("".concat(wt,"/edit"))>=0?e="\u7f16\u8f91":a.indexOf("".concat(wt,"/view"))>=0?e="\u8be6\u60c5":a.indexOf("".concat(wt,"/list"))>=0&&(e="\u67e5\u8be2"),u.a.createElement(h.a,null,u.a.createElement(xt,{width:0}),u.a.createElement(h.a,null,u.a.createElement("div",{className:"layout-content"},u.a.createElement("div",{className:"layout-content-inner"},u.a.createElement(x.a,null,u.a.createElement(x.a.Item,null,"\u5f53\u524d\u4f4d\u7f6e\uff1a"),u.a.createElement(x.a.Item,{onClick:function(){return t.props.history.push("".concat(wt))}},"\u6211\u7684\u9879\u76ee"),u.a.createElement(x.a.Item,null,e)),u.a.createElement(p.a,null,u.a.createElement(f.d,null,u.a.createElement(f.a,{path:wt,exact:!0,to:"".concat(wt,"/list")}),u.a.createElement(Re,{path:"".concat(wt,"/list"),permission:["DOCM_LIST_VIEW","DOCM_LIST_DEPT_VIEW"],component:qe}),u.a.createElement(Re,{path:"".concat(wt,"/edit/:id"),permission:"DOCM_EDIT_OPER",component:yt}),u.a.createElement(Re,{path:"".concat(wt,"/add"),permission:"DOCM_ADD_OPER",component:yt}),u.a.createElement(Re,{path:"".concat(wt,"/view/:id"),permission:"DOCM_DETAIL_VIEW",component:Ot}),u.a.createElement(f.a,{path:"".concat(wt,"/**"),to:"".concat(wt,"/list")})))))))}}]),t}(u.a.Component),St=Object(f.g)(jt),Dt=(a(576),a(577),h.a.Content),It={labelCol:{xs:{span:20},sm:{span:4}},wrapperCol:{xs:{span:20},sm:{span:16}}},Tt=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"renderContent",value:function(){return u.a.createElement(ma.Consumer,null,function(e){return u.a.createElement(N.a,It,u.a.createElement(N.a.Item,{key:"username",label:"\u7528\u6237\u540d"},e.username),u.a.createElement(N.a.Item,{key:"phone",label:"\u624b\u673a"},e.phone),u.a.createElement(N.a.Item,{key:"email",label:"\u90ae\u7bb1"},e.email),u.a.createElement(N.a.Item,{key:"dept",label:"\u79d1\u5ba4"},e.dept?e.dept.name:""))})}},{key:"render",value:function(){return u.a.createElement("div",{className:"layout-content"},u.a.createElement("div",{className:"layout-content-inner"},u.a.createElement(x.a,{separator:">"},u.a.createElement(x.a.Item,null,"\u5f53\u524d\u4f4d\u7f6e\uff1a"),u.a.createElement(x.a.Item,null,"\u6211\u7684\u8d26\u53f7"),u.a.createElement(x.a.Item,null,"\u8d26\u53f7\u4fe1\u606f")),u.a.createElement(Dt,null,u.a.createElement("div",{className:"view-page-content"},this.renderContent()))))}}]),t}(u.a.Component),Nt=Object(f.g)(Tt),At=h.a.Content,Ft={labelCol:{xs:{span:20},sm:{span:4}},wrapperCol:{xs:{span:20},sm:{span:16}}},Lt={wrapperCol:{xs:{span:2,offset:0},sm:{span:2,offset:4}}},zt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).form=void 0,a.handleSubmit=function(e){e.preventDefault(),a.form&&a.form.props.form.validateFields(function(e,t){if(!e){var n=t.id,r=t.oldPassword,l=t.password,o={id:n,oldPassword:K()(r),password:K()(l)};Y.post("/account/mod-pwd",o).then(function(e){"00000000"===e.data.status?(A.a.success("\u4fee\u6539\u6210\u529f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55"),sessionStorage.removeItem("userId"),a.props.history.push("".concat(Yt,"/mod-pwd"))):A.a.error(e.data.message)}).catch(function(e){A.a.error(e.response.data.message)})}})},a.state={id:void 0},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"renderContent",value:function(){var e=this;return u.a.createElement(ma.Consumer,null,function(t){var a=t.id;return e.state.id?e.form&&e.form.props.form.setFieldsValue({id:a}):e.setState({id:a}),u.a.createElement("div",null,u.a.createElement(Bt,{wrappedComponentRef:function(t){e.form=t}}),u.a.createElement(N.a,Lt,u.a.createElement(N.a.Item,null,u.a.createElement(b.a,{block:!0,type:"primary",onClick:e.handleSubmit},"\u63d0\u4ea4"))))})}},{key:"render",value:function(){return u.a.createElement("div",{className:"layout-content"},u.a.createElement("div",{className:"layout-content-inner"},u.a.createElement(x.a,{separator:">"},u.a.createElement(x.a.Item,null,"\u5f53\u524d\u4f4d\u7f6e\uff1a"),u.a.createElement(x.a.Item,null,"\u6211\u7684\u8d26\u53f7"),u.a.createElement(x.a.Item,null,"\u4fee\u6539\u5bc6\u7801")),u.a.createElement(At,null,u.a.createElement("div",{className:"view-page-content"},this.renderContent()))))}}]),t}(u.a.Component),Pt=Object(f.g)(zt),Mt=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form,t=e.getFieldDecorator,a=e.getFieldValue;return u.a.createElement(N.a,Ft,t("id")(u.a.createElement(I.a,{hidden:!0})),u.a.createElement(N.a.Item,{key:"oldPassword",label:"\u539f\u5bc6\u7801"},t("oldPassword",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u65e7\u5bc6\u7801",pattern:/^.{4,16}$/}],validateTrigger:"onBlur"})(u.a.createElement(I.a,{type:"password"}))),u.a.createElement(N.a.Item,{key:"password",label:"\u65b0\u5bc6\u7801"},t("password",{rules:[{required:!0,message:"\u5bc6\u7801\u4e3a4~16\u4f4d\u4efb\u610f\u5b57\u7b26",pattern:/^.{4,16}$/}],validateTrigger:"onBlur"})(u.a.createElement(I.a,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801"}))),u.a.createElement(N.a.Item,{key:"confirmPassword",label:"\u786e\u8ba4\u5bc6\u7801"},t("confirmPassword",{rules:[{message:"\u4e24\u6b21\u8f93\u5165\u5bc6\u7801\u4e0d\u4e00\u81f4",validator:function(){var e=Object(D.a)(S.a.mark(function e(t,n,r,l,o){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a("password")!==n?r("error"):r();case 2:case"end":return e.stop()}},e)}));return function(t,a,n,r,l){return e.apply(this,arguments)}}()}],validateTrigger:"onBlur"})(u.a.createElement(I.a,{type:"password",placeholder:"\u8bf7\u518d\u6b21\u8f93\u5165\u5bc6\u7801"}))))}}]),t}(u.a.Component),Bt=N.a.create({name:"mod_pwd"})(Mt),Yt="/main/account",Rt=h.a.Sider,Kt=["/info","/mod-pwd"],Ht=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).state={collapsed:!1,selectedKeys:[]},a.handleOnSelect=function(e){var t=e.key;a.setState({selectedKeys:[t]}),a.props.history.push("".concat(Yt).concat(t))},a.toggleCollapsed=function(){a.setState({collapsed:!a.state.collapsed})},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.fetchDefaultSelectedKey();this.handleOnSelect({key:e})}},{key:"fetchDefaultSelectedKey",value:function(){var e=this.props.location.pathname,t=Kt.filter(function(t){return e.indexOf(t)>=0});return t.length<1?Kt[0]:t[0]}},{key:"render",value:function(){var e=this.state.selectedKeys;return u.a.createElement(h.a,null,u.a.createElement(Rt,{width:180,theme:"dark",collapsed:this.state.collapsed,collapsedWidth:80},u.a.createElement("span",{className:"aside-top",onClick:this.toggleCollapsed},u.a.createElement(E.a,{style:{margin:"0 0 0 10px"},type:this.state.collapsed?"menu-unfold":"menu-fold"})),u.a.createElement(v.b,{selectedKeys:e,mode:"inline",theme:"dark",onSelect:this.handleOnSelect},u.a.createElement(v.b.Item,{className:"aside-item",key:"/info"},u.a.createElement(E.a,{type:"user"}),u.a.createElement("span",null,"\u8d26\u53f7\u4fe1\u606f")),u.a.createElement(v.b.Item,{className:"aside-item",key:"/mod-pwd"},u.a.createElement(E.a,{type:"safety"}),u.a.createElement("span",null,"\u4fee\u6539\u5bc6\u7801")))),u.a.createElement(h.a,null,u.a.createElement(p.a,null,u.a.createElement(f.d,null,u.a.createElement(Re,{path:"".concat(Yt,"/info"),component:Nt}),u.a.createElement(Re,{path:"".concat(Yt,"/mod-pwd"),component:Pt})))))}}]),t}(u.a.Component),_t=Object(f.g)(Ht),qt=(a(256),a(75)),Vt=(a(578),a(210)),Ut=a(92),Wt=a.n(Ut),$t=F.a.Option,Gt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).fetchUser=function(e){var t={pageSize:100,current:1,conditions:{keywordUsername:e},sorters:{username:"asc"}};a.setState({data:[],loading:!0}),setTimeout(function(){Y.post("/user/search",t).then(function(e){var t=[];"00000000"===e.data.status&&e.data.data.content.length>0&&(t=e.data.data.content.map(function(e){return{text:e.username,value:e.username}})),a.setState({data:t,loading:!1})})},300)},a.handleChange=function(e){var t=a.props.onChange;a.setState({value:e,data:[],loading:!1}),t&&t(e)},a.fetchUser=Wt()(a.fetchUser,800),a.state={param:{conditions:{ranges:{}},sorters:{}},data:[],value:[],loading:!1},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state,t=e.loading,a=e.data,n=e.value;return u.a.createElement(F.a,{value:n,placeholder:"\u641c\u7d22\u7528\u6237",notFoundContent:t?u.a.createElement(Oe.a,{size:"small"}):null,filterOption:!1,showSearch:!0,onSearch:this.fetchUser,onChange:this.handleChange,showArrow:!1,allowClear:!0,style:{width:"280px"}},a.map(function(e){return u.a.createElement($t,{key:e.value},e.text)}))}}]),t}(u.a.Component),Zt=(a(580),h.a.Content),Jt=F.a.Option,Xt=Vt.a.Panel,Qt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).handleListChange=function(){a.setState({loading:!0},function(){var e=a.state,t=e.pageSize,n=e.current,r=e.param,l=Object(y.a)({pageSize:t,current:n},r);Y.post("/operlog/list",l).then(function(e){a.setState({loading:!1,data:e.data.data})}).catch(function(e){a.setState({loading:!1})})})},a.loadOperNames=function(){Y.get("/operlog/name/list-all").then(function(e){a.setState({operNames:e.data.data})}).catch(function(e){A.a.error("\u52a0\u8f7d\u64cd\u4f5c\u540d\u79f0\u6570\u636e\u5931\u8d25")})},a.handleSelectChangeForOperator=function(e){a.state.param.conditions.operator=e,a.setState({current:1}),a.handleListChange()},a.handleSelectChangeForOperName=function(e){a.state.param.conditions.name=e,a.setState({current:1}),a.handleListChange()},a.handleDeleteOper=function(){var e=Object(D.a)(S.a.mark(function e(t){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:ce.a.confirm({title:"\u786e\u5b9a\u5220\u9664?",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){var e=Object(D.a)(S.a.mark(function e(){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="",t.forEach(function(e){return n=n.concat("ids=".concat(e,"&"))}),e.next=4,Y.delete("/operlog?".concat(n.substring(0,n.length-1)));case 4:A.a.success("\u5220\u9664\u6210\u529f"),a.handleListChange();case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleCreateTimeRangeChange=function(e){var t,n=e.target.value;if("none"!==n){var r;switch(n){case"a":r=ue()().add("day",-3).format("YYYY-MM-DD HH:mm:ss");break;case"b":r=ue()().add("day",-7).format("YYYY-MM-DD HH:mm:ss");break;case"c":r=ue()().add("month",-1).format("YYYY-MM-DD HH:mm:ss");break;case"d":r=ue()().add("month",-6).format("YYYY-MM-DD HH:mm:ss")}t={start:r,end:ue()().format("YYYY-MM-DD HH:mm:ss")}}else t=void 0;a.state.param.conditions.ranges.createTime=t,a.setState({rangeOptionValue:n,current:1}),a.handleListChange()},a.state={loading:!0,selectedRowKeys:[],modules:[],data:{total:void 0,content:[]},pageSize:10,current:1,param:{conditions:{ranges:{}},sorters:{}},activeKey:"searchPanel",rangeOptionValue:"none",operNames:[]},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.handleListChange(),this.loadOperNames()}},{key:"renderPanel",value:function(){var e=this.state.rangeOptionValue;return u.a.createElement("div",null,u.a.createElement(N.a,{labelCol:{span:2,offset:0},wrapperCol:{span:16,offset:0}},u.a.createElement(N.a.Item,{label:"\u64cd\u4f5c\u65f6\u95f4"},u.a.createElement("div",{style:{display:"flex",alignItems:"center"}},u.a.createElement("div",null,u.a.createElement(qt.a.Group,{value:e,onChange:this.handleCreateTimeRangeChange},u.a.createElement(qt.a.Button,{className:"radio-option",key:"none",value:"none"},"\u4e0d\u9650"),u.a.createElement(qt.a.Button,{className:"radio-option",key:"a",value:"a"},"\u8fd1\u4e09\u5929"),u.a.createElement(qt.a.Button,{className:"radio-option",key:"b",value:"b"},"\u8fd1\u4e00\u5468"),u.a.createElement(qt.a.Button,{className:"radio-option",key:"c",value:"c"},"\u8fd1\u4e00\u6708"),u.a.createElement(qt.a.Button,{className:"radio-option",key:"d",value:"d"},"\u8fd1\u534a\u5e74"))))),u.a.createElement(N.a.Item,{label:"\u64cd\u4f5c\u8005"},u.a.createElement(Gt,{onChange:this.handleSelectChangeForOperator}))))}},{key:"renderSearchBar",value:function(){var e=this,t=this.state,a=t.activeKey,n=t.operNames;return u.a.createElement("div",null,u.a.createElement("div",{style:{display:"flex",alignItems:"flex-start"}},u.a.createElement("div",{style:{flex:"1"}},u.a.createElement(N.a,{labelCol:{span:4,offset:0},wrapperCol:{span:8,offset:0}},u.a.createElement(N.a.Item,{label:"\u64cd\u4f5c\u540d\u79f0"},u.a.createElement(F.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"280px"},allowClear:!0,showArrow:!0,onChange:this.handleSelectChangeForOperName},n.map(function(e){return u.a.createElement(Jt,{key:e,value:e},e)}))))),u.a.createElement("div",{style:{flex:"1"}},u.a.createElement("div",{style:{float:"right"}},u.a.createElement(b.a,{type:"link",onClick:function(){return e.setState({activeKey:a?void 0:"searchPanel"})}},a?"\u6536\u8d77\u7b5b\u9009":"\u5c55\u5f00\u7b5b\u9009")))),u.a.createElement(Vt.a,{bordered:!1,activeKey:a},u.a.createElement(Xt,{key:"searchPanel",style:{border:0},showArrow:!1,header:""},this.renderPanel())))}},{key:"renderButtonBar",value:function(){var e=this,t=this.state.selectedRowKeys;return u.a.createElement(ma.Consumer,null,function(a){var n=a.permissions.find(function(e){return"DOCM_ADD_OPER"===e.id}),r=a.permissions.find(function(e){return"DOCM_DELETE_OPER"===e.id});return u.a.createElement("div",{style:{margin:"4px",flex:1}},u.a.createElement("span",{style:{float:"right"}},n&&u.a.createElement(b.a,{className:"ele-operation",type:"primary",onClick:function(){e.props.history.push("".concat(oa,"/add"))}},"\u65b0\u5efa"),r&&u.a.createElement(b.a,{type:"ghost",disabled:t.length<1,onClick:function(){e.handleDeleteOper(t)}},"\u6279\u91cf\u5220\u9664")))})}},{key:"buildColumns",value:function(){var e={onHeaderCell:function(e){return{style:{textAlign:"center",width:"10%"}}},onCell:function(e,t){return{style:{textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"}}},render:function(e){return u.a.createElement(oe.a,{placement:"topLeft",title:e},e)}};return[{title:"\u5e8f\u53f7",key:"index",render:function(e,t,a){return a+1},onHeaderCell:function(e){return{style:{textAlign:"center",width:"5%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},Object(y.a)({},e,{title:"\u64cd\u4f5c\u540d\u79f0",dataIndex:"name",key:"name"}),Object(y.a)({},e,{title:"\u6a21\u5757\u540d\u79f0",dataIndex:"module",key:"module"}),Object(y.a)({},e,{title:"\u64cd\u4f5c\u8005",dataIndex:"operator",key:"operator"}),Object(y.a)({},e,{title:"\u64cd\u4f5c\u7ed3\u679c",dataIndex:"result",key:"result",onHeaderCell:function(e){return{style:{textAlign:"center",width:"5%"}}}}),Object(y.a)({},e,{title:"\u64cd\u4f5c\u65f6\u95f4",dataIndex:"createTime",key:"createTime",render:function(e,t,a){return ue()(t.createTime).format("YYYY-MM-DD HH:mm:ss")},sorter:function(e,t){return e.id-t.id}})]}},{key:"renderTable",value:function(){var e=this,t=this.state,a=t.loading,n=t.data,r=t.pageSize,l=t.current,o=t.selectedRowKeys,c=n.total,i=n.content;return u.a.createElement(ma.Consumer,null,function(t){var s=t.permissions.find(function(e){return"DOCM_DELETE_OPER"===e.id})?{columnWidth:"30px",selectedRowKeys:o,onChange:function(t){e.setState({selectedRowKeys:t})}}:void 0;return a||n.content.length>0?u.a.createElement(le.a,{rowKey:function(e){return e.id},rowSelection:s,columns:e.buildColumns(),dataSource:i,loading:a,onRow:function(t,a){return{onClick:function(a){"TD"===a.target.tagName&&e.props.history.push("".concat(oa,"/view/").concat(t.id))}}},size:"small",pagination:{total:c,current:l,pageSize:r,pageSizeOptions:["10","20","50"],showSizeChanger:!0,onShowSizeChange:function(t,a){e.setState({current:1,pageSize:a})},showTotal:function(e){return"\u5171 ".concat(e," \u6761")}},onChange:function(t,a,n,r){var l=e.state.param,o=t.current,c=t.pageSize,i=n.field,s=n.order;l.sorters={},i&&s&&(l.sorters[de(i)]=function(e){return"descend"===e?"desc":"asc"}(s)),e.setState({current:o,pageSize:c}),e.handleListChange()}}):u.a.createElement(re.a,{description:"\u6682\u65e0\u5185\u5bb9"})})}},{key:"render",value:function(){return u.a.createElement(Zt,null,u.a.createElement("div",{className:"list-page"},u.a.createElement("div",{className:"list-page-content"},u.a.createElement("div",{className:"list-page-content-toolbar"},u.a.createElement("div",{className:"list-page-content-toolbar-search"},this.renderSearchBar()),u.a.createElement("div",{className:"list-page-content-toolbar-button"},this.renderButtonBar())),u.a.createElement("div",{className:"list-page-content-table"},this.renderTable()))))}}]),t}(u.a.Component);var ea=Object(f.g)(Qt),ta=h.a.Content,aa={span:12,offset:0},na={labelCol:{span:4,offset:2},wrapperCol:{span:16,offset:0}},ra=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).handleCancel=function(e){e.preventDefault(),a.props.history.push("".concat(oa,"/list"))},a.state={loading:!0,data:void 0},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;this.setState({loading:!0},function(){Y.get("/operlog?id=".concat(t)).then(function(t){e.setState({loading:!1,data:t.data.data})}).catch(function(e){})})}},{key:"renderContent",value:function(){var e=this.state,t=e.loading,a=e.data;return!t&&a?u.a.createElement(N.a,na,u.a.createElement(rt.a,null,u.a.createElement(lt.a,aa,u.a.createElement(N.a.Item,{key:"name",label:"\u64cd\u4f5c\u540d\u79f0"},a.name)),u.a.createElement(lt.a,aa,u.a.createElement(N.a.Item,{key:"module",label:"\u6a21\u5757\u540d\u79f0"},a.module))),u.a.createElement(rt.a,null,u.a.createElement(lt.a,aa,u.a.createElement(N.a.Item,{key:"operator",label:"\u64cd\u4f5c\u8005"},a.operator)),u.a.createElement(lt.a,aa,u.a.createElement(N.a.Item,{key:"createTime",label:"\u64cd\u4f5c\u65f6\u95f4"},a.createTime))),u.a.createElement(rt.a,null,u.a.createElement(lt.a,aa,u.a.createElement(N.a.Item,{key:"result",label:"\u64cd\u4f5c\u7ed3\u679c"},a.result))),u.a.createElement(rt.a,null,u.a.createElement(lt.a,aa,u.a.createElement(N.a.Item,{key:"ip",label:"\u8fdc\u7a0bIP"},a.ip)),u.a.createElement(lt.a,aa,u.a.createElement(N.a.Item,{key:"userAgent",label:"UserAgent"},a.userAgent))),u.a.createElement(rt.a,null,u.a.createElement(lt.a,aa,u.a.createElement(N.a.Item,{key:"method",label:"HTTP\u65b9\u6cd5"},a.method)),u.a.createElement(lt.a,aa,u.a.createElement(N.a.Item,{key:"url",label:"URL"},a.url))),u.a.createElement(rt.a,null,u.a.createElement(lt.a,aa,u.a.createElement(N.a.Item,{key:"contractNum",label:"\u64cd\u4f5c\u5185\u5bb9"},a.content)),u.a.createElement(lt.a,aa))):u.a.createElement(Oe.a,{size:"large"})}},{key:"render",value:function(){return u.a.createElement(ta,null,u.a.createElement("div",{style:{margin:"4px 4px 10px",display:"flex",alignItems:"center"}},u.a.createElement("div",{style:{margin:"4px",flex:1}},u.a.createElement("span",{style:{float:"right"}},u.a.createElement(b.a,{type:"default",onClick:this.handleCancel},"\u8fd4\u56de")))),u.a.createElement("div",{style:{margin:"8px"}},this.renderContent()))}}]),t}(u.a.Component),la=Object(f.g)(ra),oa="/main/operlog",ca=h.a.Sider,ia=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e,t=this,a=this.props.location.pathname;return a.indexOf("".concat(oa,"/view"))>=0?e="\u8be6\u60c5":a.indexOf("".concat(oa,"/list"))>=0&&(e="\u67e5\u8be2"),u.a.createElement(h.a,null,u.a.createElement(ca,{width:0}),u.a.createElement(h.a,null,u.a.createElement("div",{className:"layout-content"},u.a.createElement("div",{className:"layout-content-inner"},u.a.createElement(x.a,null,u.a.createElement(x.a.Item,null,"\u5f53\u524d\u4f4d\u7f6e\uff1a"),u.a.createElement(x.a.Item,{onClick:function(){return t.props.history.push("".concat(oa))}},"\u65e5\u5fd7\u5ba1\u8ba1"),u.a.createElement(x.a.Item,null,e)),u.a.createElement(p.a,null,u.a.createElement(f.d,null,u.a.createElement(f.a,{path:oa,exact:!0,to:"".concat(oa,"/list")}),u.a.createElement(Re,{path:"".concat(oa,"/list"),component:ea}),u.a.createElement(Re,{path:"".concat(oa,"/view/:id"),component:la}),u.a.createElement(f.a,{path:"".concat(oa,"/**"),to:"".concat(oa,"/list")})))))))}}]),t}(u.a.Component),sa=Object(f.g)(ia),ua=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return u.a.createElement(ma.Consumer,null,function(e){var t=C.filter(function(t){return!!e.username&&("admin"===e.username?t.role.filter(function(e){return"admin"===e}).length>0:t.role.filter(function(e){return"normal"===e}).length>0)}),a=[{key:"/docm",value:u.a.createElement(f.b,{key:"docm",path:"/main/docm",component:St})},{key:"/user",value:u.a.createElement(f.b,{key:"user",path:"/main/user",component:Me})},{key:"/account",value:u.a.createElement(f.b,{key:"account",path:"/main/account",component:_t})},{key:"/operlog",value:u.a.createElement(f.b,{key:"operlog",path:"/main/operlog",component:sa})}];return t.length>0&&u.a.createElement(p.a,null,u.a.createElement(f.d,null,u.a.createElement(f.a,{path:"/main",exact:!0,to:"/main".concat(t[0].key)}),a.filter(function(e){return t.filter(function(t){return t.key===e.key}).length>0}).map(function(e){return e.value})))})}}]),t}(u.a.Component),da=Object(f.g)(ua),ma=(a(581),u.a.createContext({})),pa=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).state={collapsed:!1,userInfo:{}},a.toggleCollapsed=function(){a.setState({collapsed:!a.state.collapsed})},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;Y.get("/account?id=".concat(sessionStorage.getItem("userId"))).then(function(t){var a=Object(y.a)({},t.data.data);e.setState({userInfo:a})}).catch(function(e){})}},{key:"render",value:function(){var e=this.state.userInfo;return e.id?u.a.createElement(ma.Provider,{value:e},u.a.createElement(h.a,{className:"ant-layout-home"},u.a.createElement(w,null),u.a.createElement(da,null))):u.a.createElement("div",null)}}]),t}(s.Component),fa=a(293),ha=a.n(fa),ya=a(294),ga=a.n(ya),Ea=(a(582),function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).form=void 0,a.handleSubmit=function(e){e.preventDefault(),a.form&&a.form.props.form.validateFields(function(){var e=Object(D.a)(S.a.mark(function e(t,n){var r;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=4;break}return r=K()(n.password),e.next=4,Y.post("/account/login",Object(y.a)({},n,{password:r})).then(function(e){"00000000"===e.data.status?(sessionStorage.setItem("userId",e.data.data.id),setTimeout(function(){a.props.history.push("/main")},300)):a.form&&a.form.props.form.setFields({password:{value:n.password,errors:[new Error(e.data.message)]}})}).catch(function(e){A.a.error("\u670d\u52a1\u5668\u5f02\u5e38")});case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}())},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"login"},u.a.createElement("img",{className:"login-img",src:ha.a,alt:""}),u.a.createElement("div",{className:"login-form"},u.a.createElement("div",{className:"login-form-top"},u.a.createElement("div",{className:"logo"},u.a.createElement("a",{href:"/"},u.a.createElement("img",{className:"logo-img",src:ga.a,alt:"logo"}),u.a.createElement("span",{className:"logo-text"},"Contract MS"))),u.a.createElement("div",{className:"logo-desc"},"\u6b22\u8fce\u767b\u5f55\u5408\u540c\u7ba1\u7406\u7cfb\u7edf")),u.a.createElement(Ca,{wrappedComponentRef:function(t){e.form=t}}),u.a.createElement(b.a,{className:"login-form-item",type:"primary",onClick:this.handleSubmit},"\u767b\u5f55")),u.a.createElement("div",{className:"copyright"}))}}]),t}(u.a.Component)),va=Object(f.g)(Ea),ba=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return u.a.createElement(N.a,{layout:"vertical"},u.a.createElement(N.a.Item,null,e("username",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}]})(u.a.createElement(I.a,{className:"login-form-item",prefix:u.a.createElement(E.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"\u7528\u6237\u540d"}))),u.a.createElement(N.a.Item,null,e("password",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801"}]})(u.a.createElement(I.a,{className:"login-form-item",prefix:u.a.createElement(E.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"\u5bc6\u7801"}))))}}]),t}(u.a.Component),Ca=N.a.create({name:"normal_login"})(ba),ka=a(297),Oa=(a(583),a(584),function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return u.a.createElement(n.a,{locale:ka.a},u.a.createElement(p.a,null,u.a.createElement(f.d,null,u.a.createElement(f.a,{path:"/",exact:!0,to:"/main"}),u.a.createElement(f.b,{path:"/login",component:va}),u.a.createElement(Re,{path:"/main",component:pa}))))}}]),t}(s.PureComponent));m.a.render(u.a.createElement(Oa,null),document.getElementById("root"))}},[[302,1,2]]]);
//# sourceMappingURL=main.b2bac533.chunk.js.map